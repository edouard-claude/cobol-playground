IDENTIFICATION DIVISION.
PROGRAM-ID. booking.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 BOOKINGS.
   05 BOOKING OCCURS 10 TIMES.
      10 BOOKING-NAME PIC X(20).
      10 BOOKING-DATE PIC X(10).

01 BOOKING-IDX PIC 9(2) VALUE 0.
01 BOOKING-NAME-TEMP PIC X(20).
01 BOOKING-DATE-TEMP PIC X(10).

PROCEDURE DIVISION.
START-PROGRAM.
    DISPLAY "WELCOME TO THE BOOKING SYSTEM".
    PERFORM UNTIL EXIT
        DISPLAY "1. ADD BOOKING"
        DISPLAY "2. LIST BOOKINGS"
        DISPLAY "3. EXIT"
        ACCEPT BOOKING-IDX
        EVALUATE BOOKING-IDX
            WHEN 1 PERFORM ADD-BOOKING
            WHEN 2 PERFORM LIST-BOOKINGS
            WHEN 3 EXIT PROGRAM
            WHEN OTHER DISPLAY "INVALID OPTION"
        END-EVALUATE
    END-PERFORM
    .

ADD-BOOKING.
    IF BOOKING-IDX < 10
        DISPLAY "ENTER BOOKING NAME: " WITH NO ADVANCING
        ACCEPT BOOKING-NAME-TEMP
        DISPLAY "ENTER BOOKING DATE (YYYY-MM-DD): " WITH NO ADVANCING
        ACCEPT BOOKING-DATE-TEMP
        MOVE BOOKING-NAME-TEMP TO BOOKING-NAME (BOOKING-IDX + 1)
        MOVE BOOKING-DATE-TEMP TO BOOKING-DATE (BOOKING-IDX + 1)
        ADD 1 TO BOOKING-IDX
        DISPLAY "BOOKING ADDED SUCCESSFULLY!"
    ELSE
        DISPLAY "ALL BOOKING SLOTS ARE FULL!"
    END-IF
    .

LIST-BOOKINGS.
    IF BOOKING-IDX > 0
        PERFORM VARYING BOOKING-IDX FROM 1 BY 1 UNTIL BOOKING-IDX > 10
            DISPLAY "BOOKING " BOOKING-IDX ": " 
                    BOOKING-NAME (BOOKING-IDX) " ON " BOOKING-DATE (BOOKING-IDX)
        END-PERFORM
    ELSE
        DISPLAY "NO BOOKINGS MADE YET!"
    END-IF
    .
