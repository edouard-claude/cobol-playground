IDENTIFICATION DIVISION.
PROGRAM-ID. PencilInventory.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  PENCILS.
    05 PENCIL OCCURS 5 TIMES INDEXED BY PENCIL-IDX.
       10 PENCIL-COLOR    PIC X(10).
       10 PENCIL-STOCK    PIC 9(4) VALUE 0.
01  CHOICE               PIC 9 VALUE 0.
01  PENCIL-TO-ADD        PIC X(10).
01  QUANTITY-TO-ADD      PIC 9(4).
01  PENCIL-TO-REMOVE     PIC X(10).
01  QUANTITY-TO-REMOVE   PIC 9(4).

PROCEDURE DIVISION.
BEGIN.
    PERFORM INIT-PENCILS.
    PERFORM UNTIL CHOICE = 4
        DISPLAY "1. Show pencils"
        DISPLAY "2. Add pencils"
        DISPLAY "3. Remove pencils"
        DISPLAY "4. Quit"
        DISPLAY "Enter your choice: " WITH NO ADVANCING
        ACCEPT CHOICE
        EVALUATE CHOICE
            WHEN 1 PERFORM SHOW-PENCILS
            WHEN 2 PERFORM ADD-PENCILS
            WHEN 3 PERFORM REMOVE-PENCILS
            WHEN OTHER CONTINUE
        END-EVALUATE
    END-PERFORM
    STOP RUN.

INIT-PENCILS.
    MOVE "Red" TO PENCIL-COLOR(1)
    MOVE "Blue" TO PENCIL-COLOR(2)
    MOVE "Green" TO PENCIL-COLOR(3)
    MOVE "Yellow" TO PENCIL-COLOR(4)
    MOVE "Black" TO PENCIL-COLOR(5).

SHOW-PENCILS.
    PERFORM VARYING PENCIL-IDX FROM 1 BY 1 UNTIL PENCIL-IDX > 5
        DISPLAY PENCIL-COLOR (PENCIL-IDX) " : " PENCIL-STOCK (PENCIL-IDX)
    END-PERFORM.

ADD-PENCILS.
    DISPLAY "Enter pencil color to add to: " WITH NO ADVANCING
    ACCEPT PENCIL-TO-ADD
    DISPLAY "Enter quantity to add: " WITH NO ADVANCING
    ACCEPT QUANTITY-TO-ADD
    PERFORM VARYING PENCIL-IDX FROM 1 BY 1 UNTIL PENCIL-IDX > 5
        IF PENCIL-COLOR(PENCIL-IDX) = PENCIL-TO-ADD
            ADD QUANTITY-TO-ADD TO PENCIL-STOCK(PENCIL-IDX)
        END-IF
    END-PERFORM.

REMOVE-PENCILS.
    DISPLAY "Enter pencil color to remove from: " WITH NO ADVANCING
    ACCEPT PENCIL-TO-REMOVE
    DISPLAY "Enter quantity to remove: " WITH NO ADVANCING
    ACCEPT QUANTITY-TO-REMOVE
    PERFORM VARYING PENCIL-IDX FROM 1 BY 1 UNTIL PENCIL-IDX > 5
        IF PENCIL-COLOR(PENCIL-IDX) = PENCIL-TO-REMOVE
            IF QUANTITY-TO-REMOVE <= PENCIL-STOCK(PENCIL-IDX)
                SUBTRACT QUANTITY-TO-REMOVE FROM PENCIL-STOCK(PENCIL-IDX)
            ELSE
                DISPLAY "Error: Not enough pencils in inventory."
            END-IF
        END-IF
    END-PERFORM.
